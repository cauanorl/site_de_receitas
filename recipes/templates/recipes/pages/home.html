{% extends 'recipes/base/base.html' %}
{% load static %}


{% block head %}

    <title>{{ title }} | Recipes</title>

{% endblock %}

{% block content %}

  {% if category_name %}
    <div class="container" style="text-align:center;">
      <h2>Filter by: {{ category_name }}</h2>
    </div>
  {% endif %}

  <div class="main-content main-content-list container">

    {% for recipe in recipes %}
      {% include 'recipes/partials/_recipe.html' with recipe=recipe %}
    {% empty %}
      {% if search %}
        <h1 style="text-align: center; margin: 10rem 0rem;">Nenhuma receita para a pesquisa: {{ search }}</h1>
      {% else %}
        <h1 style="text-align: center; margin: 10rem 0rem;">Nenhuma receita publicada no momento</h1>
      {% endif %}
    {% endfor %}

  </div>

  {% if page_obj %}
    <div class="main-content container" style="text-align:center;">

      {% comment %} {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}{% if search %}&q={{search}}{% endif %}">{{ page_obj.previous_page_number }}</a>
      {% endif %}

      Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}

      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}{% if search %}&q={{search}}{% endif %}">{{ page_obj.next_page_number }}</a>
      {% endif %} {% endcomment %}

      {% for page in page_obj.paginator %}

        {% with page_obj.number|add:"-3" as min_page and page_obj.number|add:3 as max_page %}

          {% if max_page >= page.number and min_page <= page.number %}
            {% if page.number == page_obj.number %}
              {{ page.number }}
            {% else %}
              <a href="?page={{ page.number }}{% if search %}&q={{search}}{% endif %}">{{ page.number }}</a>
            {% endif %}
          {% endif %}
          
        {% endwith %}

      {% endfor  %}
    <div>
  {% endif %}

{% endblock %}